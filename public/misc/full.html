<!-- vim: set nomodeline: -->
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>/home/krone/Development/ghostty-shader-playground/server.js</title>
<meta name="colorscheme" content="catppuccin-mocha"></meta>
<style>
* {font-family: monospace}
body {background-color: #0b0e14; color: #c1c9e6}
.Number {color: #fab770}
.-constructor {color: #faca64}
.Conditional {color: #ff8f40; font-style: italic}
.-string-regexp {color: #fab770}
.DiagnosticUnderlineHint {text-decoration-line: underline; text-decoration-color: #4cd4bd}
.String {color: #70cf67}
.-ibl-scope-underline-1 {text-decoration-line: underline; text-decoration-color: #c1c9e6}
.Type {color: #faca64}
.-keyword-operator {color: #ff8f40}
.Constant {color: #fab770}
.-spell {}
.-keyword-return {color: #ff8f40}
.Exception {color: #ff8f40}
.-ibl-whitespace-char-1 {color: #2f313d}
.-string-escape {color: #ad6ff7}
.Function {color: #00bfff}
.LspReferenceRead {background-color: #2f313d}
.Repeat {color: #ff8f40}
.Comment {color: #7d8296; font-style: italic}
.-variable {color: #c1c9e6}
.-ibl-scope-char-1 {color: #c1c9e6}
.-variable-builtin {color: #e66767}
.-type-builtin {color: #ff8f40}
.-variable-parameter {color: #eb788b}
.Keyword {color: #ff8f40}
.-ibl-indent-char-1 {color: #1d1e29}
.Special {color: #ad6ff7}
.-keyword-function {color: #ff8f40}
.Delimiter {color: #7d8296}
.-punctuation-bracket {color: #7d8296}
.-none {}
.-variable-member {color: #c1c9e6}
.Boolean {color: #fab770}
.-function-builtin {color: #fab770}
.Operator {color: #61bdff}
</style>
</head>
<body style="display: flex">
<pre>
<span class="Keyword">const</span> <span class="-variable">http</span> <span class="Operator">=</span> <span class="-variable"><span class="Function"><span class="-function-builtin"><span class="DiagnosticUnderlineHint">require</span></span><span class="DiagnosticUnderlineHint"></span></span><span class="DiagnosticUnderlineHint"></span></span><span class="DiagnosticUnderlineHint"><span class="-punctuation-bracket">(</span><span class="String">&quot;http&quot;</span><span class="-punctuation-bracket">)</span></span><span class="-punctuation-bracket"></span><span class="Delimiter">;</span>
<span class="Keyword">const</span> <span class="-variable">fs</span> <span class="Operator">=</span> <span class="-variable"><span class="Function"><span class="-function-builtin">require</span></span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;fs&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="Keyword">const</span> <span class="-variable">path</span> <span class="Operator">=</span> <span class="-variable"><span class="Function"><span class="-function-builtin">require</span></span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;path&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="Keyword">const</span> <span class="-variable"><span class="Type">WebSocket</span></span> <span class="Operator">=</span> <span class="-variable"><span class="Function"><span class="-function-builtin">require</span></span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;ws&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>

<span class="Keyword">const</span> <span class="-variable"><span class="Type"><span class="Constant">PORT</span></span></span> <span class="Operator">=</span> <span class="Number">3000</span><span class="Delimiter">;</span>
<span class="Keyword">const</span> <span class="-variable"><span class="Type"><span class="Constant">ROOT_DIR</span></span></span> <span class="Operator">=</span> <span class="-variable">__dirname</span><span class="Delimiter">;</span>
<span class="Keyword">const</span> <span class="-variable"><span class="Type"><span class="Constant">PUBLIC_DIR</span></span></span> <span class="Operator">=</span> <span class="-variable">path</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">join</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="Type"><span class="Constant">ROOT_DIR</span></span></span><span class="Delimiter">,</span> <span class="String">&quot;public&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="Keyword">const</span> <span class="-variable"><span class="Type"><span class="Constant">SHADERS_DIR</span></span></span> <span class="Operator">=</span> <span class="-variable">path</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">join</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="Type"><span class="Constant">ROOT_DIR</span></span></span><span class="Delimiter">,</span> <span class="String">&quot;public&quot;</span><span class="Delimiter">,</span> <span class="String">&quot;shaders&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>

<span class="Keyword">const</span> <span class="-variable">args</span> <span class="Operator">=</span> <span class="-variable">process</span><span class="Delimiter">.</span><span class="-variable-member">argv</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">slice</span></span><span class="-punctuation-bracket">(</span><span class="Number">2</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="Keyword">const</span> <span class="-variable">shouldOpenBrowser</span> <span class="Operator">=</span> <span class="-variable">args</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">includes</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;--open&quot;</span><span class="-punctuation-bracket">)</span> <span class="Operator">||</span> <span class="-variable">args</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">includes</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;-o&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>

<span class="Keyword">const</span> <span class="-variable"><span class="Type"><span class="Constant">MIME_TYPES</span></span></span> <span class="Operator">=</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;.html&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;text/html&quot;</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;.js&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;application/javascript&quot;</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;.glsl&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;text/plain&quot;</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;.json&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;application/json&quot;</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;.css&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;text/css&quot;</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;.ico&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;image/x-icon&quot;</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;.png&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;image/png&quot;</span><span class="Delimiter">,</span>
<span class="-punctuation-bracket">}</span><span class="Delimiter">;</span>

<span class="Keyword">const</span> <span class="-variable">server</span> <span class="Operator">=</span> <span class="-variable">http</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">createServer</span></span><span class="-punctuation-bracket">(</span><span class="-variable">handleRequest</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>

<span class="-keyword-function">function</span> <span class="-variable"><span class="Function">handleRequest</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">req</span></span><span class="Delimiter">,</span> <span class="-variable"><span class="-variable-parameter">res</span></span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">safeUrl</span> <span class="Operator">=</span> <span class="-variable">req</span><span class="Delimiter">.</span><span class="-variable-member">url</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">split</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;?&quot;</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">[</span><span class="Number">0</span><span class="-punctuation-bracket">]</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">split</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;#&quot;</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">[</span><span class="Number">0</span><span class="-punctuation-bracket">]</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">urlPath</span> <span class="Operator">=</span> <span class="-variable">safeUrl</span> <span class="Operator">===</span> <span class="String">&quot;/&quot;</span> <span class="Operator">?</span> <span class="String">&quot;/index.html&quot;</span> <span class="Delimiter"><span class="Operator">:</span></span> <span class="-variable">safeUrl</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">requestedPath</span> <span class="Operator">=</span> <span class="-variable">path</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">join</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="Type"><span class="Constant">PUBLIC_DIR</span></span></span><span class="Delimiter">,</span> <span class="-variable">urlPath</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">normalizedPath</span> <span class="Operator">=</span> <span class="-variable">path</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">normalize</span></span><span class="-punctuation-bracket">(</span><span class="-variable">requestedPath</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">req</span><span class="Delimiter">.</span><span class="-variable-member">url</span> <span class="Operator">===</span> <span class="String">&quot;/shaders-list&quot;</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-keyword-return">return</span> <span class="-variable"><span class="Function">listShaders</span></span><span class="-punctuation-bracket">(</span><span class="-variable">res</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-whitespace-char-1"> </span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="Operator">!</span><span class="-variable">normalizedPath</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">startsWith</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="Type"><span class="Constant">PUBLIC_DIR</span></span></span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-whitespace-char-1"> </span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-whitespace-char-1"> </span><span class="-keyword-return">return</span> <span class="-variable"><span class="Function">notFound</span></span><span class="-punctuation-bracket">(</span><span class="-variable">res</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-keyword-return">return</span> <span class="-variable"><span class="Function">serveFile</span></span><span class="-punctuation-bracket">(</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">normalizedPath</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Type"><span class="Constant">MIME_TYPES</span></span></span><span class="-punctuation-bracket">[</span><span class="-variable">path</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">extname</span></span><span class="-punctuation-bracket">(</span><span class="-variable">normalizedPath</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">]</span> <span class="Operator">||</span> <span class="String">&quot;application/octet-stream&quot;</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">res</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-punctuation-bracket">}</span>

<span class="-keyword-function">function</span> <span class="-variable"><span class="Function">serveFile</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">filePath</span></span><span class="Delimiter">,</span> <span class="-variable"><span class="-variable-parameter">mimeType</span></span><span class="Delimiter">,</span> <span class="-variable"><span class="-variable-parameter">res</span></span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">fs</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">readFile</span></span><span class="-punctuation-bracket">(</span><span class="-variable">filePath</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">err</span></span><span class="Delimiter">,</span> <span class="-variable"><span class="-variable-parameter">content</span></span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">err</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">err</span><span class="Delimiter">.</span><span class="-variable-member">code</span> <span class="Operator">===</span> <span class="String">&quot;ENOENT&quot;</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-keyword-return">return</span> <span class="-variable"><span class="Function">notFound</span></span><span class="-punctuation-bracket">(</span><span class="-variable">res</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">error</span></span><span class="-punctuation-bracket">(</span><span class="String">`Error reading file: <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">filePath</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="Delimiter">,</span> <span class="-variable">err</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">writeHead</span></span><span class="-punctuation-bracket">(</span><span class="Number">500</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">{</span> <span class="String">&quot;Content-Type&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;text/plain&quot;</span> <span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-keyword-return">return</span> <span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">end</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;Server error&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">writeHead</span></span><span class="-punctuation-bracket">(</span><span class="Number">200</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">{</span> <span class="String">&quot;Content-Type&quot;</span><span class="Delimiter">:</span> <span class="-variable">mimeType</span> <span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">end</span></span><span class="-punctuation-bracket">(</span><span class="-variable">content</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-punctuation-bracket">}</span>

<span class="-keyword-function">function</span> <span class="-variable"><span class="Function">listShaders</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">res</span></span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">fs</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">readdir</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="Type"><span class="Constant">SHADERS_DIR</span></span></span><span class="Delimiter">,</span> <span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">err</span></span><span class="Delimiter">,</span> <span class="-variable"><span class="-variable-parameter">files</span></span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">err</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">error</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;Failed to read shaders directory&quot;</span><span class="Delimiter">,</span> <span class="-variable">err</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">writeHead</span></span><span class="-punctuation-bracket">(</span><span class="Number">500</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">{</span> <span class="String">&quot;Content-Type&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;application/json&quot;</span> <span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-keyword-return">return</span> <span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">end</span></span><span class="-punctuation-bracket">(</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Type"><span class="Constant">JSON</span></span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">stringify</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">{</span> <span class="-variable-member">error</span><span class="Delimiter">:</span> <span class="String">&quot;Unable to read shaders directory&quot;</span> <span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">,</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">shaderFiles</span> <span class="Operator">=</span> <span class="-variable">files</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">filter</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">f</span></span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-variable">f</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">endsWith</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;.glsl&quot;</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">writeHead</span></span><span class="-punctuation-bracket">(</span><span class="Number">200</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">{</span> <span class="String">&quot;Content-Type&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;application/json&quot;</span> <span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">end</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="Type"><span class="Constant">JSON</span></span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">stringify</span></span><span class="-punctuation-bracket">(</span><span class="-variable">shaderFiles</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-punctuation-bracket">}</span>

<span class="-keyword-function">function</span> <span class="-variable"><span class="Function">notFound</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">res</span></span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">writeHead</span></span><span class="-punctuation-bracket">(</span><span class="Number">404</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">{</span> <span class="String">&quot;Content-Type&quot;</span><span class="Delimiter">:</span> <span class="String">&quot;text/plain&quot;</span> <span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">res</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">end</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;Not found&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-punctuation-bracket">}</span>

<span class="Keyword">const</span> <span class="-variable">wss</span> <span class="Operator">=</span> <span class="-keyword-operator">new</span> <span class="-variable"><span class="Type">WebSocket</span></span><span class="Delimiter">.</span><span class="-variable-member">Server</span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">{</span> <span class="-variable-member">server</span> <span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>

<span class="-keyword-function"><span class="-ibl-scope-underline-1">function</span></span><span class="-ibl-scope-underline-1"> <span class="-variable"><span class="Function"><span class="LspReferenceRead">broadcastReload</span></span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span></span><span class="-punctuation-bracket"></span> <span class="Comment">  You • Sat 05 Jul 2025 05:05:09 AM -03 • Select menu for shader</span>
<span class="-ibl-scope-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">wss</span><span class="Delimiter">.</span><span class="-variable-member">clients</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">forEach</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">client</span></span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-scope-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">client</span><span class="Delimiter">.</span><span class="-variable-member">readyState</span> <span class="Operator">===</span> <span class="-variable"><span class="Type">WebSocket</span></span><span class="Delimiter">.</span><span class="-variable-member">OPEN</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-scope-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">client</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">send</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;reload&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-scope-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-scope-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-punctuation-bracket">}</span>
<span class="-keyword-function">function</span> <span class="-variable"><span class="Function">broadcastReloadShader</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">file</span></span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">wss</span><span class="Delimiter">.</span><span class="-variable-member">clients</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">forEach</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">client</span></span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">client</span><span class="Delimiter">.</span><span class="-variable-member">readyState</span> <span class="Operator">===</span> <span class="-variable"><span class="Type">WebSocket</span></span><span class="Delimiter">.</span><span class="-variable-member">OPEN</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">client</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">send</span></span><span class="-punctuation-bracket">(</span><span class="-variable">file</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-punctuation-bracket">}</span>

<span class="-keyword-function">function</span> <span class="-variable"><span class="Function">watchForChanges</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">toWatch</span> <span class="Operator">=</span> <span class="-punctuation-bracket">[</span><span class="-variable"><span class="Type"><span class="Constant">PUBLIC_DIR</span></span></span><span class="-punctuation-bracket">]</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Repeat">for</span> <span class="-punctuation-bracket">(</span><span class="Keyword">const</span> <span class="-variable">p</span> <span class="Repeat">of</span> <span class="-variable">toWatch</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Exception">try</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">stats</span> <span class="Operator">=</span> <span class="-variable">fs</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">lstatSync</span></span><span class="-punctuation-bracket">(</span><span class="-variable">p</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">stats</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">isDirectory</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Exception">try</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">fs</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">watch</span></span><span class="-punctuation-bracket">(</span><span class="-variable">p</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">{</span> <span class="-variable-member">recursive</span><span class="Delimiter">:</span> <span class="Boolean">true</span> <span class="-punctuation-bracket">}</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter"><span class="Comment">event</span></span></span><span class="Delimiter">,</span> <span class="-variable"><span class="-variable-parameter">filename</span></span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="Operator">!</span><span class="-variable">filename</span><span class="-punctuation-bracket">)</span> <span class="-keyword-return">return</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">`Changed: <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">filename</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">filename</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">endsWith</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;.glsl&quot;</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">broadcastReloadShader</span></span><span class="-punctuation-bracket">(</span><span class="-variable">filename</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span> <span class="Conditional">else</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function"><span class="LspReferenceRead">broadcastReload</span></span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span> <span class="Exception">catch</span> <span class="-punctuation-bracket">(</span><span class="-variable">recursiveError</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">watchDirectoryRecursively</span></span><span class="-punctuation-bracket">(</span><span class="-variable">p</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span> <span class="Conditional">else</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">fs</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">watchFile</span></span><span class="-punctuation-bracket">(</span><span class="-variable">p</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">`File changed: <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">path</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">basename</span></span><span class="-punctuation-bracket">(</span><span class="-variable">p</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function"><span class="LspReferenceRead">broadcastReload</span></span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span> <span class="Exception">catch</span> <span class="-punctuation-bracket">(</span><span class="-variable">err</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">error</span></span><span class="-punctuation-bracket">(</span><span class="String">`Failed to watch: <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">p</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="Delimiter">,</span> <span class="-variable">err</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-punctuation-bracket">}</span>

<span class="Keyword">const</span> <span class="-variable">pending</span> <span class="Operator">=</span> <span class="-keyword-operator">new</span> <span class="-variable"><span class="Type"><span class="-type-builtin"><span class="-constructor">Map</span></span></span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>

<span class="-keyword-function">function</span> <span class="-variable"><span class="Function"><span class="Comment">scheduleReload</span></span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">filename</span></span><span class="Delimiter">,</span> <span class="-variable"><span class="-variable-parameter">isShader</span></span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">clearTimeout</span></span><span class="-punctuation-bracket">(</span><span class="-variable">pending</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">get</span></span><span class="-punctuation-bracket">(</span><span class="-variable">filename</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">timeout</span> <span class="Operator">=</span> <span class="-variable"><span class="Function">setTimeout</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">isShader</span><span class="-punctuation-bracket">)</span> <span class="-variable"><span class="Function">broadcastReloadShader</span></span><span class="-punctuation-bracket">(</span><span class="-variable">filename</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">else</span> <span class="-variable"><span class="Function"><span class="LspReferenceRead">broadcastReload</span></span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">pending</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">delete</span></span><span class="-punctuation-bracket">(</span><span class="-variable">filename</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="Delimiter">,</span> <span class="Number">100</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span> <span class="Comment"><span class="-spell">// debounce time</span></span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">pending</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">set</span></span><span class="-punctuation-bracket">(</span><span class="-variable">filename</span><span class="Delimiter">,</span> <span class="-variable">timeout</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-punctuation-bracket">}</span>
<span class="Keyword">let</span> <span class="-variable">reloadTimer</span><span class="Delimiter">;</span>

<span class="-keyword-function">function</span> <span class="-variable"><span class="Function">watchDirectoryRecursively</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">dirPath</span></span><span class="Delimiter">,</span> <span class="-variable"><span class="-variable-parameter">depth</span></span> <span class="Operator">=</span> <span class="Number">0</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">fs</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">watch</span></span><span class="-punctuation-bracket">(</span><span class="-variable">dirPath</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter"><span class="Comment">event</span></span></span><span class="Delimiter">,</span> <span class="-variable"><span class="-variable-parameter">filename</span></span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="Operator">!</span><span class="-variable">filename</span><span class="-punctuation-bracket">)</span> <span class="-keyword-return">return</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Comment"><span class="-spell">// ignore changes from tmp files ?</span></span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="Operator">!</span><span class="-variable">filename</span> <span class="Operator">||</span> <span class="-variable">filename</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">endsWith</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;~&quot;</span><span class="-punctuation-bracket">)</span> <span class="Operator">||</span> <span class="-punctuation-bracket">/</span><span class="-string-regexp">^\d+$</span><span class="-punctuation-bracket">/</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">test</span></span><span class="-punctuation-bracket">(</span><span class="-variable">filename</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span> <span class="-keyword-return">return</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">clearTimeout</span></span><span class="-punctuation-bracket">(</span><span class="-variable">reloadTimer</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">reloadTimer</span> <span class="Operator">=</span> <span class="-variable"><span class="Function">setTimeout</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">`<span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">performance</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">now</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">/</span> <span class="Number">1000</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>[<span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">depth</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>] Changed: <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">filename</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">filename</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">endsWith</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;.glsl&quot;</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">broadcastReloadShader</span></span><span class="-punctuation-bracket">(</span><span class="-variable">filename</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span> <span class="Conditional">else</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function"><span class="LspReferenceRead">broadcastReload</span></span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="Delimiter">,</span> <span class="Number">10</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Exception">try</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">entries</span> <span class="Operator">=</span> <span class="-variable">fs</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">readdirSync</span></span><span class="-punctuation-bracket">(</span><span class="-variable">dirPath</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">{</span> <span class="-variable-member">withFileTypes</span><span class="Delimiter">:</span> <span class="Boolean">true</span> <span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Repeat">for</span> <span class="-punctuation-bracket">(</span><span class="Keyword">const</span> <span class="-variable">entry</span> <span class="Repeat">of</span> <span class="-variable">entries</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">entry</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">isDirectory</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">subDirPath</span> <span class="Operator">=</span> <span class="-variable">path</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">join</span></span><span class="-punctuation-bracket">(</span><span class="-variable">dirPath</span><span class="Delimiter">,</span> <span class="-variable">entry</span><span class="Delimiter">.</span><span class="-variable-member">name</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">watchDirectoryRecursively</span></span><span class="-punctuation-bracket">(</span><span class="-variable">subDirPath</span><span class="Delimiter">,</span> <span class="-variable">depth</span> <span class="Operator">+</span> <span class="Number">1</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span> <span class="Exception">catch</span> <span class="-punctuation-bracket">(</span><span class="-variable">err</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">error</span></span><span class="-punctuation-bracket">(</span><span class="String">`Error reading directory <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">dirPath</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>:`</span><span class="Delimiter">,</span> <span class="-variable">err</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-punctuation-bracket">}</span>

<span class="-variable"><span class="Function">watchForChanges</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>

<span class="-variable">server</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">listen</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="Type"><span class="Constant">PORT</span></span></span><span class="Delimiter">,</span> <span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">`Server running at http://localhost:<span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable"><span class="Type"><span class="Constant">PORT</span></span></span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">shouldOpenBrowser</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-punctuation-bracket">{</span> <span class="-variable">exec</span> <span class="-punctuation-bracket">}</span> <span class="Operator">=</span> <span class="-variable"><span class="Function"><span class="-function-builtin">require</span></span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;child_process&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">url</span> <span class="Operator">=</span> <span class="String">`http://localhost:<span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable"><span class="Type"><span class="Constant">PORT</span></span></span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">commands</span> <span class="Operator">=</span> <span class="-punctuation-bracket">[</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;xdg-open&quot;</span><span class="Delimiter">,</span> <span class="Comment"><span class="-spell">// Linux</span></span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;open&quot;</span><span class="Delimiter">,</span> <span class="Comment"><span class="-spell">// macOS</span></span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="String">&quot;start&quot;</span><span class="Delimiter">,</span> <span class="Comment"><span class="-spell">// Windows</span></span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">]</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">let</span> <span class="-variable">commandIndex</span> <span class="Operator">=</span> <span class="Number">0</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable"><span class="Function">tryOpenBrowser</span></span> <span class="Operator">=</span> <span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">commandIndex</span> <span class="Operator">&gt;=</span> <span class="-variable">commands</span><span class="Delimiter">.</span><span class="-variable-member">length</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">`Please open your browser and navigate to: <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">url</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-keyword-return">return</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Keyword">const</span> <span class="-variable">command</span> <span class="Operator">=</span> <span class="-variable">commands</span><span class="-punctuation-bracket">[</span><span class="-variable">commandIndex</span><span class="-punctuation-bracket">]</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">exec</span></span><span class="-punctuation-bracket">(</span><span class="String">`<span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">command</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span> <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">url</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">error</span></span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">error</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">commandIndex</span><span class="Operator">++</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">tryOpenBrowser</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span> <span class="Conditional">else</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">`Browser opened: <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">url</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>`</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Comment"><span class="-spell">// wait a moment for the server to be ready</span></span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">setTimeout</span></span><span class="-punctuation-bracket">(</span><span class="-variable">tryOpenBrowser</span><span class="Delimiter">,</span> <span class="Number">500</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>

<span class="Keyword">let</span> <span class="-variable">isShuttingDown</span> <span class="Operator">=</span> <span class="Boolean">false</span><span class="Delimiter">;</span>

<span class="-keyword-function">function</span> <span class="-variable"><span class="Function">gracefulShutdown</span></span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">signal</span></span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional"><span class="-ibl-scope-underline-1">if</span></span><span class="-ibl-scope-underline-1"> <span class="-punctuation-bracket">(</span><span class="-variable">isShuttingDown</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span></span><span class="-punctuation-bracket"></span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-scope-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-keyword-return">return</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">isShuttingDown</span> <span class="Operator">=</span> <span class="Boolean">true</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">`<span class="-string-escape">\n</span>Received <span class="-none"><span class="-none"><span class="Special">${</span><span class="-variable">signal</span><span class="-punctuation-bracket"><span class="Special">}</span></span></span></span>. Shutting down gracefully...`</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">wss</span><span class="Delimiter">.</span><span class="-variable-member">clients</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">forEach</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">(</span><span class="-variable"><span class="-variable-parameter">client</span></span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="Conditional">if</span> <span class="-punctuation-bracket">(</span><span class="-variable">client</span><span class="Delimiter">.</span><span class="-variable-member">readyState</span> <span class="Operator">===</span> <span class="-variable"><span class="Type">WebSocket</span></span><span class="Delimiter">.</span><span class="-variable-member">OPEN</span><span class="-punctuation-bracket">)</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">client</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">close</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">wss</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">close</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;WebSocket server closed&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">server</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">close</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;HTTP server closed&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">process</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">exit</span></span><span class="-punctuation-bracket">(</span><span class="Number">0</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="Function">setTimeout</span></span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-punctuation-bracket">{</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable"><span class="-variable-builtin">console</span></span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">log</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;Force closing server...&quot;</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-variable">process</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">exit</span></span><span class="-punctuation-bracket">(</span><span class="Number">1</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-ibl-indent-char-1">▎</span><span class="-ibl-whitespace-char-1"> </span><span class="-punctuation-bracket">}</span><span class="Delimiter">,</span> <span class="Number">3000</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-punctuation-bracket">}</span>

<span class="-variable">process</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">on</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;SIGINT&quot;</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-variable"><span class="Function">gracefulShutdown</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;SIGINT&quot;</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>
<span class="-variable">process</span><span class="Delimiter">.</span><span class="-variable-member"><span class="Function">on</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;SIGTERM&quot;</span><span class="Delimiter">,</span> <span class="-punctuation-bracket">(</span><span class="-punctuation-bracket">)</span> <span class="Operator">=&gt;</span> <span class="-variable"><span class="Function">gracefulShutdown</span></span><span class="-punctuation-bracket">(</span><span class="String">&quot;SIGTERM&quot;</span><span class="-punctuation-bracket">)</span><span class="-punctuation-bracket">)</span><span class="Delimiter">;</span>

</pre>
</body>
</html>

